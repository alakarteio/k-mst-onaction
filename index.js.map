{"version":3,"file":"index.js","sources":["src/helpers/take.js","src/helpers/index.js","src/middleware.js"],"sourcesContent":["import { isRegExp, isString, isFunction } from 'lodash'\n\nconst take = (match, callback) => (action, tree) => {\n  const isMatching = false\n    || (isString(match) && match === action.fullpath)\n    || (isFunction(match) && match(action, tree))\n    || (isRegExp(match) && action.fullpath.match(match))\n\n  if (isMatching) return callback(action, tree)\n  return false\n}\n\nconst ended = (match, callback) => (action, tree) => {\n  if (action.ended) return take(match, callback)(action, tree)\n  return false\n}\n\ntake.ended = ended\n\nexport default take\n","// eslint-disable-next-line import/prefer-default-export\nexport { default as take } from './take'\n","import { getPath } from 'mobx-state-tree'\n\nconst getAction = (call) => {\n  const {\n    name,\n    type,\n    context,\n    args,\n  } = call\n\n  const path = getPath(context)\n  const fullpath = `${path}/${name}`\n\n  const action = {\n    fullpath,\n    path,\n    name,\n    args,\n  }\n\n  switch (type) {\n    case 'process_return': return { ...action, ended: true }\n    case 'action': return action\n    default: return undefined\n  }\n}\n\nexport default dispatch => (call, next) => {\n  const action = getAction(call)\n\n  if (action) {\n    const runner = dispatch()\n    let step = { done: false }\n\n    while (!step.done) {\n      step = runner.next()\n      if (!step.done) step.value(action, call.tree)\n    }\n  }\n\n  return next(call)\n}\n"],"names":["take","match","callback","action","tree","isMatching","isString","fullpath","isFunction","isRegExp","ended","getAction","call","name","type","context","args","path","getPath","undefined","next","runner","dispatch","step","done","value"],"mappings":";;;;;;AAEA,IAAMA,OAAO,SAAPA,IAAO,CAACC,KAAD,EAAQC,QAAR;SAAqB,UAACC,MAAD,EAASC,IAAT,EAAkB;QAC5CC,aAAa,SACbC,gBAASL,KAAT,KAAmBA,UAAUE,OAAOI,QADvB,IAEbC,kBAAWP,KAAX,KAAqBA,MAAME,MAAN,EAAcC,IAAd,CAFR,IAGbK,gBAASR,KAAT,KAAmBE,OAAOI,QAAP,CAAgBN,KAAhB,CAAsBA,KAAtB,CAHzB;;QAKII,UAAJ,EAAgB,OAAOH,SAASC,MAAT,EAAiBC,IAAjB,CAAP;WACT,KAAP;GAPW;CAAb;;AAUA,IAAMM,QAAQ,SAARA,KAAQ,CAACT,KAAD,EAAQC,QAAR;SAAqB,UAACC,MAAD,EAASC,IAAT,EAAkB;QAC/CD,OAAOO,KAAX,EAAkB,OAAOV,KAAKC,KAAL,EAAYC,QAAZ,EAAsBC,MAAtB,EAA8BC,IAA9B,CAAP;WACX,KAAP;GAFY;CAAd;;AAKAJ,KAAKU,KAAL,GAAaA,KAAb;;ACjBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACEA,IAAMC,YAAY,SAAZA,SAAY,CAACC,IAAD,EAAU;MAExBC,IAFwB,GAMtBD,IANsB,CAExBC,IAFwB;MAGxBC,IAHwB,GAMtBF,IANsB,CAGxBE,IAHwB;MAIxBC,OAJwB,GAMtBH,IANsB,CAIxBG,OAJwB;MAKxBC,IALwB,GAMtBJ,IANsB,CAKxBI,IALwB;;;MAQpBC,OAAOC,sBAAQH,OAAR,CAAb;MACMR,WAAcU,IAAd,SAAsBJ,IAA5B;;MAEMV,SAAS;sBAAA;cAAA;cAAA;;GAAf;;UAOQW,IAAR;SACO,gBAAL;0BAAmCX,MAAZ,IAAoBO,OAAO,IAA3B;SAClB,QAAL;aAAsBP,MAAP;;aACCgB,SAAP;;CArBb;;AAyBA,kBAAe;SAAY,UAACP,IAAD,EAAOQ,IAAP,EAAgB;QACnCjB,SAASQ,UAAUC,IAAV,CAAf;;QAEIT,MAAJ,EAAY;UACJkB,SAASC,UAAf;UACIC,OAAO,EAAEC,MAAM,KAAR,EAAX;;aAEO,CAACD,KAAKC,IAAb,EAAmB;eACVH,OAAOD,IAAP,EAAP;YACI,CAACG,KAAKC,IAAV,EAAgBD,KAAKE,KAAL,CAAWtB,MAAX,EAAmBS,KAAKR,IAAxB;;;;WAIbgB,KAAKR,IAAL,CAAP;GAba;CAAf;;;;;;;;;;;;;"}